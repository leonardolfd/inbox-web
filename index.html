<script>
const REPL_URL = "https://c32da2d5-0519-4a62-92cb-20b43cfe77a5-00-1er4j7p5c2dco.riker.replit.dev/api/emails";

async function carregarEmails() {
    const filtro = document.getElementById("filtro").value.toLowerCase();
    const div = document.getElementById("emails");
    div.innerHTML = "<p>Carregando...</p>";

    try {
        const resposta = await fetch(REPL_URL);
        const data = await resposta.json();
        div.innerHTML = "";
        const filtrados = data.filter(email => email.toLowerCase().includes(filtro));
        if (filtrados.length === 0) {
            div.innerHTML = "<p>Nenhum e-mail encontrado.</p>";
        } else {
            filtrados.forEach(email => {
                const bloco = document.createElement("div");
                bloco.className = "email";
                bloco.innerHTML = `
                    <div class="from">${email.split('|')[0]}</div>
                    <div class="subject">${email.split('|')[1]}</div>
                    <div class="date">${email.split('|')[2]}</div>
                `;
                div.appendChild(bloco);
            });
        }
    } catch (erro) {
        console.error("Erro:", erro);
        div.innerHTML = "<p>Erro ao buscar e-mails.</p>";
    }
}

carregarEmails();
</script>